<div class="container-fluid min-vh-100 d-flex flex-column">
  <!-- Header -->
  <nav class="navbar navbar-light bg-light shadow-sm">
    <div class="container-fluid">
      <button class="btn btn-outline-primary" (click)="volverAInicio()">
        <i class="bi bi-arrow-left"></i> Volver al Inicio
      </button>
      <h3 class="mb-0">Mis Reservas</h3>
      <div>
        <span class="badge bg-info me-2">
          <i class="bi bi-currency-exchange me-1"></i>Precios en FCFA
        </span>
        <button class="btn btn-success btn-sm" (click)="irANuevaReserva()">
          <i class="bi bi-plus-circle me-1"></i>Nueva Reserva
        </button>
      </div>
    </div>
  </nav>

  <!-- Contenido principal -->
  <div class="container py-4 flex-grow-1">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="mb-0">Mis Reservas</h1>
      <button class="btn btn-primary" (click)="irANuevaReserva()">
        <i class="bi bi-plus-lg me-1"></i>Nueva Reserva
      </button>
    </div>

    <!-- Estado de carga -->
    <div *ngIf="cargando" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3">Cargando tus reservas...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error && !cargando" class="alert alert-danger text-center">
      <i class="bi bi-exclamation-triangle me-2"></i>{{ error }}
      <button class="btn btn-sm btn-outline-danger ms-3" (click)="cargarReservas()">
        Reintentar
      </button>
    </div>

    <!-- Si no hay reservas -->
    <div *ngIf="!cargando && !error && reservas.length === 0" class="card text-center p-5 shadow-sm">
      <i class="bi bi-calendar-x display-1 text-muted mb-3"></i>
      <h4 class="mb-3">No tienes reservas</h4>
      <p class="text-muted mb-4">Comienza creando tu primera reserva.</p>
      <div class="d-flex justify-content-center gap-3">
        <button class="btn btn-primary" (click)="irANuevaReserva()">
          <i class="bi bi-plus-circle me-2"></i>Crear Primera Reserva
        </button>
        <button class="btn btn-outline-secondary" (click)="volverAInicio()">
          <i class="bi bi-search me-2"></i>Explorar Hoteles
        </button>
      </div>
    </div>

    <!-- Lista de reservas -->
    <div *ngIf="!cargando && reservas.length > 0" class="row">
      <div *ngFor="let reserva of reservas" class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 shadow-sm border-0">
          <div class="card-header bg-primary text-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="card-title mb-0">Reserva #{{ reserva.id }}</h5>
              <span [class]="getEstadoClass(reserva.estadoReserva)">
                {{ getEstadoText(reserva.estadoReserva) }}
              </span>
            </div>
          </div>
          
          <div class="card-body">
            <!-- Información del hotel -->
            <div *ngIf="reserva.hotel" class="mb-3">
              <h6 class="fw-bold">
                <i class="bi bi-building me-2"></i>{{ reserva.hotel.nombre }}
              </h6>
              <p class="text-muted small mb-2">
                <i class="bi bi-geo-alt me-1"></i>{{ reserva.hotel.ubicacion }}
              </p>
            </div>

            <!-- Fechas de la reserva -->
            <div class="mb-3">
              <h6 class="fw-bold">Fechas:</h6>
              <div class="d-flex justify-content-between">
                <div>
                  <small class="text-muted">Check-in</small>
                  <p class="mb-0 fw-semibold">{{ formatearFecha(reserva.fechaEntrada) }}</p>
                </div>
                <div class="text-center">
                  <i class="bi bi-arrow-right text-primary"></i>
                  <p class="small text-muted mb-0">{{ calcularNoches(reserva.fechaEntrada, reserva.fechaSalida) }} noches</p>
                </div>
                <div class="text-end">
                  <small class="text-muted">Check-out</small>
                  <p class="mb-0 fw-semibold">{{ formatearFecha(reserva.fechaSalida) }}</p>
                </div>
              </div>
            </div>

            <!-- Detalles de la reserva -->
            <div class="mb-3">
              <h6 class="fw-bold">Detalles:</h6>
              <div class="row small">
                <div class="col-6">
                  <p class="mb-1">
                    <i class="bi bi-person me-1"></i>
                    Huéspedes: {{ reserva.numeroHuespedes }}
                  </p>
                </div>
                <div class="col-6 text-end">
                  <p *ngIf="reserva.habitacion" class="mb-1">
                    <i class="bi bi-door-closed me-1"></i>
                    {{ reserva.habitacion.tipo }}
                  </p>
                </div>
              </div>
              <div *ngIf="reserva.pedidoEspecial">
                <p class="mb-1 small">
                  <i class="bi bi-chat-text me-1"></i>
                  {{ reserva.pedidoEspecial }}
                </p>
              </div>
            </div>

            <!-- Precio total -->
            <div class="border-top pt-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <small class="text-muted">Total a pagar</small>
                  <h4 class="text-primary mb-0">{{ formatearPrecio(reserva.precioTotal) }}</h4>
                </div>
                <div>
                  <small class="text-muted d-block">Fecha de reserva</small>
                  <small>{{ formatearFecha(reserva.fechaReserva || '') }}</small>
                </div>
              </div>
            </div>
          </div>

          <!-- Botones de acción -->
          <div class="card-footer bg-transparent border-top-0">
            <div class="d-flex gap-2">
              <button *ngIf="reserva.estadoReserva === 'PENDIENTE'" 
                class="btn btn-outline-danger btn-sm flex-grow-1"
                (click)="cancelarReserva(reserva.id!)">
                <i class="bi bi-x-circle me-1"></i>Cancelar Reserva
              </button>
              <button *ngIf="reserva.estadoReserva === 'CANCELADA'" 
                class="btn btn-outline-secondary btn-sm flex-grow-1"
                (click)="eliminarReserva(reserva.id!)">
                <i class="bi bi-trash me-1"></i>Eliminar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>