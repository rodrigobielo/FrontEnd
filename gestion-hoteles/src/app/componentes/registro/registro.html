<div class="p-4 p-md-5">
  <!-- Encabezado -->
  <div class="text-center mb-4">
    <div class="mb-3">
      <i class="bi bi-person-plus-fill text-primary display-4"></i>
    </div>
    <h2 class="fw-bold mb-2" style="color: #1a365d;">Registro de Usuario</h2>
    <p class="text-muted mb-0">Complete todos los campos para crear su cuenta</p>
  </div>

  <!-- Formulario -->
  <form [formGroup]="registroForm" (ngSubmit)="onSubmit()" novalidate class="needs-validation">
    
    <!-- Sección: Información Personal -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-bottom">
        <h5 class="mb-0 fw-semibold text-primary">
          <i class="bi bi-person-vcard me-2"></i>Información Personal
        </h5>
      </div>
      <div class="card-body">
        <!-- Nombre y Apellidos -->
        <div class="row g-3">
          <div class="col-md-6">
            <label for="nombre" class="form-label fw-medium">
              <i class="bi bi-person me-1 text-primary"></i>Nombre <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="nombre"
              formControlName="nombre"
              [class.is-valid]="campoValido('nombre')"
              [class.is-invalid]="campoInvalido('nombre')"
              placeholder="Ingrese su nombre"
              [attr.aria-describedby]="f['nombre'].invalid ? 'nombreError' : null">
            <div id="nombreError" class="invalid-feedback" *ngIf="mostrarError('nombre')">
              <div *ngIf="f['nombre'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>El nombre es obligatorio
              </div>
              <div *ngIf="f['nombre'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>2-50 letras (solo caracteres válidos)
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <label for="apellidos" class="form-label fw-medium">
              <i class="bi bi-person-badge me-1 text-primary"></i>Apellidos <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="apellidos"
              formControlName="apellidos"
              [class.is-valid]="campoValido('apellidos')"
              [class.is-invalid]="campoInvalido('apellidos')"
              placeholder="Introduzca sus apellidos">
            <div class="invalid-feedback" *ngIf="mostrarError('apellidos')">
              <div *ngIf="f['apellidos'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>Los apellidos son obligatorios
              </div>
              <div *ngIf="f['apellidos'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>2-80 letras (solo caracteres válidos)
              </div>
            </div>
          </div>
        </div>

        <!-- Teléfono y Nacionalidad -->
        <div class="row g-3 mt-3">
          <div class="col-md-6">
            <label for="telefono" class="form-label fw-medium">
              <i class="bi bi-telephone me-1 text-primary"></i>Teléfono <span class="text-danger">*</span>
            </label>
            <input 
              type="tel" 
              class="form-control form-control-lg" 
              id="telefono"
              formControlName="telefono"
              [class.is-valid]="campoValido('telefono')"
              [class.is-invalid]="campoInvalido('telefono')"
              placeholder="+240 ">
            <div class="invalid-feedback" *ngIf="mostrarError('telefono')">
              <div *ngIf="f['telefono'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>El teléfono es obligatorio
              </div>
              <div *ngIf="f['telefono'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>Formato: 8-20 dígitos
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <label for="nacionalidad" class="form-label fw-medium">
              <i class="bi bi-globe me-1 text-primary"></i>Nacionalidad <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="nacionalidad"
              formControlName="nacionalidad"
              [class.is-valid]="campoValido('nacionalidad')"
              [class.is-invalid]="campoInvalido('nacionalidad')"
              placeholder="Nacionalidad">
            <div class="invalid-feedback" *ngIf="mostrarError('nacionalidad')">
              <div *ngIf="f['nacionalidad'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>La nacionalidad es obligatoria
              </div>
              <div *ngIf="f['nacionalidad'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>3-50 letras (solo caracteres válidos)
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección: Documentación -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-bottom">
        <h5 class="mb-0 fw-semibold text-primary">
          <i class="bi bi-file-earmark-text me-2"></i>Documentación
        </h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-12">
            <label for="documento" class="form-label fw-medium">
              <i class="bi bi-card-text me-1 text-primary"></i>DNI o Pasaporte <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="documento"
              formControlName="documento"
              [class.is-valid]="campoValido('documento')"
              [class.is-invalid]="campoInvalido('documento')"
              placeholder="DIP o Pasaporte">
            <div class="invalid-feedback" *ngIf="mostrarError('documento')">
              <div *ngIf="f['documento'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>El documento es obligatorio
              </div>
              <div *ngIf="f['documento'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>5-20 caracteres alfanuméricos
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección: Credenciales -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-bottom">
        <h5 class="mb-0 fw-semibold text-primary">
          <i class="bi bi-shield-lock me-2"></i>Credenciales de Acceso
        </h5>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label for="usuario" class="form-label fw-medium">
              <i class="bi bi-person-circle me-1 text-primary"></i>Usuario <span class="text-danger">*</span>
            </label>
            <input 
              type="text" 
              class="form-control form-control-lg" 
              id="usuario"
              formControlName="usuario"
              [class.is-valid]="campoValido('usuario')"
              [class.is-invalid]="campoInvalido('usuario')"
              placeholder="4-20 caracteres">
            <div class="invalid-feedback" *ngIf="mostrarError('usuario')">
              <div *ngIf="f['usuario'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>El usuario es obligatorio
              </div>
              <div *ngIf="f['usuario'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>4-20 caracteres (letras, números, guión bajo)
              </div>
            </div>
            <small class="form-text text-muted mt-1 d-block">
              <i class="bi bi-info-circle me-1"></i>No se permiten espacios ni caracteres especiales
            </small>
          </div>
          
          <div class="col-md-6">
            <label for="contrasena" class="form-label fw-medium">
              <i class="bi bi-key me-1 text-primary"></i>Contraseña <span class="text-danger">*</span>
            </label>
            <input 
              type="password" 
              class="form-control form-control-lg" 
              id="contrasena"
              formControlName="contrasena"
              [class.is-valid]="campoValido('contrasena')"
              [class.is-invalid]="campoInvalido('contrasena')"
              placeholder="••••••••">
            <div class="invalid-feedback" *ngIf="mostrarError('contrasena')">
              <div *ngIf="f['contrasena'].errors?.['required']">
                <i class="bi bi-exclamation-circle me-1"></i>La contraseña es obligatoria
              </div>
              <div *ngIf="f['contrasena'].errors?.['pattern']">
                <i class="bi bi-exclamation-circle me-1"></i>
                8+ caracteres con mayúscula, minúscula, número y carácter especial
              </div>
            </div>
            <small class="form-text text-muted mt-1 d-block">
              <i class="bi bi-lightbulb me-1"></i>Mínimo 8 caracteres con mayúscula, minúscula, número y carácter especial
            </small>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección: Foto (Opcional) -->
    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-transparent border-bottom">
        <h5 class="mb-0 fw-semibold text-primary">
          <i class="bi bi-camera me-2"></i>Foto de Perfil <span class="text-muted fw-normal fs-6">(opcional)</span>
        </h5>
      </div>
      <div class="card-body">
        <div class="row align-items-center">
          <div class="col-md-4 text-center mb-3 mb-md-0">
            <div class="position-relative d-inline-block">
              <img 
                [src]="fotoPreview || 'https://via.placeholder.com/150/6c757d/ffffff?text=Sin+foto'" 
                class="img-thumbnail rounded-circle border-3 border-light shadow-sm" 
                style="width: 150px; height: 150px; object-fit: cover;" 
                alt="Vista previa de la foto">
              <button 
                *ngIf="fotoPreview" 
                type="button" 
                class="btn btn-danger btn-sm rounded-circle position-absolute top-0 end-0 m-1 shadow"
                (click)="removerFoto()"
                title="Eliminar foto">
                <i class="bi bi-x-lg"></i>
              </button>
            </div>
          </div>
          
          <div class="col-md-8">
            <div class="mb-3">
              <label for="foto" class="form-label fw-medium">Seleccionar archivo</label>
              <div class="input-group input-group-lg">
                <input 
                  type="file" 
                  class="form-control" 
                  id="foto"
                  (change)="onFileSelected($event)"
                  accept="image/jpeg,image/png,image/gif"
                  [class.is-valid]="fotoValida && !fotoError">
                <button 
                  class="btn btn-outline-primary" 
                  type="button"
                  (click)="seleccionarArchivo()">
                  <i class="bi bi-folder2-open me-1"></i>Examinar
                </button>
              </div>
            </div>
            
            <div *ngIf="fotoError" class="alert alert-danger alert-dismissible fade show" role="alert">
              <i class="bi bi-exclamation-triangle me-2"></i>{{ fotoError }}
              <button type="button" class="btn-close" (click)="fotoError = ''"></button>
            </div>
            
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <small>
                Formatos aceptados: JPG, PNG, GIF. Tamaño máximo: 2MB.
                Este campo es opcional y puede completarse más tarde.
              </small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensaje de advertencia -->
    <div class="alert alert-warning mb-4">
      <i class="bi bi-exclamation-triangle me-2"></i>
      <small class="fw-medium">
        Todos los campos marcados con <span class="text-danger">*</span> son obligatorios.
        Por favor, verifique que toda la información sea correcta antes de enviar.
      </small>
    </div>

    <!-- Botones de acción -->
    <div class="d-grid gap-2 mb-4">
      <button 
        type="submit" 
        class="btn btn-primary btn-lg py-3 fw-semibold"
        [disabled]="registroForm.invalid || isLoading">
        <span *ngIf="!isLoading">
          <i class="bi bi-person-plus me-1"></i>Registrarse
        </span>
        <span *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-1" role="status"></span>
          Enviando...
        </span>
      </button>

      <button 
        type="button" 
        class="btn btn-outline-secondary btn-lg py-3"
        (click)="limpiarFormulario()"
        [disabled]="isLoading">
        <i class="bi bi-arrow-counterclockwise me-1"></i>Limpiar Formulario
      </button>
    </div>
  </form>

  <!-- Enlace a login -->
  <div class="text-center pt-3 border-top">
    <p class="text-muted mb-2">
      ¿Ya tiene una cuenta?
    </p>
    <button type="button" class="btn btn-outline-primary w-100 py-2 fw-medium" (click)="onIrALogin()">
      <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar Sesión
    </button>
  </div>

  <!-- Footer -->
  <div class="text-center mt-4">
    <p class="small text-muted">
      <i class="bi bi-shield-check me-1"></i>
      Su información está protegida y encriptada. Al registrarse, acepta nuestros 
      <a href="#" class="text-decoration-none fw-medium">Términos de Servicio</a> 
      y 
      <a href="#" class="text-decoration-none fw-medium">Política de Privacidad</a>
    </p>
  </div>
</div>